<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="edit.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Millionaire</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>

        function onload() {
            document.getElementById('displayQuestion').style.display = "none";
            document.getElementById('gamePage').style.display = "none";
            document.getElementById('addQuestion').style.display = "none";
            document.getElementById('addAnswer').style.display = "none";
            document.getElementById('editQuestion').style.display = "none";
            document.getElementById('result').style.display = "none";
        }

        function startGame() {
            $.get('/getOneQuestion', function (data, status) {
                var html = "";
                html += data.result[0].questions;

                $.post('/getAnswers', { answer_id: data.result[0].answers_id, answer_type: data.result[0].answer_type }, function (dataAnswer, status) {

                    var rand = Math.floor(Math.random() * Math.floor(3));
                    var count = 0;
                    var htmlAns = "<table class='table'><tr>";
                    for (var i = 0; i < 3; i++) {
                        if (count == 2) {
                            htmlAns += "</tr><tr>";
                        }

                        if (count == rand) {
                            htmlAns += "<td class='td'><span class='hover input'>" + data.result[0].answer + "</span></td>";
                            count += 1;
                        }

                        if (count == 2) {
                            htmlAns += "</tr><tr>";
                        }

                        htmlAns += "<td class='td'><span class='hover input'>" + dataAnswer.result[i].answer + "</span></td>";
                        count += 1;
                    }
                    if (count == 3) {
                        htmlAns += "<td class='td'><span class='hover input'>" + data.result[0].answer + "</span></td>";
                        count += 1;
                    }

                    htmlAns += "</tr></table>";

                    document.getElementById('gameQuestion').innerHTML = html;
                    document.getElementById('gameAnswers').innerHTML = htmlAns;
                    document.getElementById('mainPage').style.display = "none";
                    document.getElementById('gamePage').style.display = "block";
                    document.getElementById('result').style.display = "none";
                });

            });

        }

        function displayQuestion() {
            $.get('/getQuestion', function (data, status) {
                var html = "<table>";
                for (var i = 0; i < data.result.length; i++) {
                    html += "<tr><td>" + (i + 1) + ") </td><td>" + data.result[i].questions + "</td></tr>";
                }
                html += "<table><br>";
                document.getElementById('questions').innerHTML = html;
                document.getElementById('mainPage').style.display = "none";
                document.getElementById('displayQuestion').style.display = "block";
            });
        }

        function addQuestion() {
            $.get('/getAnswer', function (dataAnswer, status) {

                var addQuestionhtml = "Enter New Question:  <textarea id='newQuestion' name='newQuestion' row='1' cols='50'required></textarea><br><br>";

                addQuestionhtml += "Select Answer: <select id='typeSelect' name='answerSelect' required>";
                addQuestionhtml += "<option>Choose Answer</option>";
                for (var i = 0; i < dataAnswer.result.length; i++) {
                    addQuestionhtml += "<option value=" + dataAnswer.result[i].id + ">" + dataAnswer.result[i].type + "</option><br>";
                }
                addQuestionhtml += "</select><br>";


                document.getElementById('addanswer').innerHTML = addQuestionhtml;

                document.getElementById('displayQuestion').style.display = "none";
                document.getElementById('addQuestion').style.display = "block";
            });
        }

        function addAnswer() {
            $.get('/getTypes', function (dataTypes, status) {

                var addAnswerhtml = "Select Type: <select id='typeSelect' name='typeSelect' required>";
                addAnswerhtml += "<option>Choose Types</option>";
                for (var i = 0; i < dataTypes.result.length; i++) {
                    addAnswerhtml += "<option value=" + dataTypes.result[i].id + ">" + dataTypes.result[i].type + "</option><br>";
                }
                addAnswerhtml += "</select><br>";

                addAnswerhtml += "Enter New Answer:  <textarea id='newAnswer' name='newAnswer' row='1' cols='50'required></textarea><br><br>";


                document.getElementById('addanswer').innerHTML = addAnswerhtml;

                document.getElementById('displayQuestion').style.display = "none";
                document.getElementById('addAnswer').style.display = "block";
            });
        }

        function editQuestion(id) {
            // $.get('/getQuestion', function (data, status) {

            $.get('/getAnswer?id=' + id, function (dataAnswer, status) {
                var editQuestionhtml = "Update question:  <textarea id='editquestion' name='editquestion' row='1' cols='50'required></textarea><br><br>";
                editQuestionhtml += "Select Type: <select id='answerSelect' name='answerSelect' required>";
                editQuestionhtml += "<option>Choose Answer</option>";
                for (var i = 0; i < dataAnswer.result.length; i++) {
                    editQuestionhtml += "<option value=" + dataAnswer.result[i].id + ">" + dataAnswer.result[i].answer + "</option><br>";
                }
                editQuestionhtml += "</select><br>";



                document.getElementById('editQuestion').innerHTML = editQuestionhtml;
                document.getElementById('displayQuestion').style.display = "none";

                document.getElementById('editQuestion').style.display = "block";
            });
        }

        function backToMain() {
            document.getElementById('displayQuestion').style.display = "none";

            document.getElementById('mainPage').style.display = "block";
        }

        function result() {
            document.getElementById('gamePage').style.display = "none";

            document.getElementById('result').style.display = "block";
        }

        function startOver() {
            document.getElementById('mainPage').style.display = "block";

            document.getElementById('result').style.display = "none";
        }


        function submitResponse(response) {
            if (response == "question") {
                // $.post('/saveQuestion', function(dataSaveQuestion, status){

                // })
            } else if (response == "answer") {
                var answer = document.getElementById('newAnswer').value;
                var answer_type = document.getElementById('typeSelect').value;

                $.post('/saveAnswer', { answer: answer, answer_type: answer_type }, function (dataSaveAnswer, status) {
                    if (dataSaveAnswer.status == "Success") {
                        alert("Adding answer Successful.");
                        document.getElementById('displayQuestion').style.display = "block";
                        document.getElementById('addQuestion').style.display = "none";
                        document.getElementById('addAnswer').style.display = "none";
                        document.getElementById('editQuestion').style.display = "none";

                    } else {
                        alert("Adding answer Unsuccessful");
                    }

                });
            } else {
                var answer = document.getElementById('newAnswer').value;
                var answer_type = document.getElementById('typeSelect').value;

                $.post('/editQuestion', { question: question, answer_id: answer_id, id: id }, function (dataEditQuestion, status) {
                    if (dataEditQuestion.status == "Success") {
                        alert("Editing Question Successful.");
                        document.getElementById('displayQuestion').style.display = "block";
                        document.getElementById('addQuestion').style.display = "none";
                        document.getElementById('addAnswer').style.display = "none";
                        document.getElementById('editQuestion').style.display = "none";
                    }
                });
            }
        }
    </script>
</head>

<body onload="onload()" style="background-color: darkblue;">
    <img src="logo.png" width='766px' height='581.33px'>

    <div id="mainPage">
        <br>
        <button class="button" onclick="startGame()" style="margin-left:220px">Start Game</Button>
        <button class="button" onclick="displayQuestion()">Edit Questions</Button>
    </div>


    <div id="displayQuestion" class="text">
        <button class='button' onclick="backToMain()">Go Back</a></button><br><br>
        <p>
            <h1><b>Displaying All Questions:</b></h1><br>
            <div id="questions"> </div>
            <button class='button' onclick="addQuestion()">Add Question</a></button>
            <button class='button' onclick="addAnswer()">Add Answer</a></button>
        </p>
    </div>


    <div id="addQuestion">
        <p>
            <h1><b>Add New Questions:</b></h1>
        </p><br>
        <div class="text" id="addQuestion"></div>
        <button class='button' onclick="submitResponse('question')">Submit</button>
    </div>

    <div id="addAnswer" class="text">
        <p>
            <h1><b>Add New Answers:</b></h1>
        </p><br>
        <div class="text" id="addanswer"></div>
        <button class='button' onclick="submitResponse('answer')">Submit</button>
    </div>

    <div id="editQuestion">
        <p>
            <h1><b>Edit Question:</b></h1><br>
            <div id="editQuestion" class="text"></div>
            <!-- <form action="displayquestions.php" onsubmit='return confirmation()' method="POST">
                  <?php
            
                $result = $questionValue->fetch(PDO::FETCH_ASSOC);
                $result = $result['questions'];
                echo "<div class='indent'>";
                  echo "Enter New Question:  <textarea name='editquestion' row='2' cols='50' id='question' required>$result</textarea><br><br>";
            
                  echo "Select Answer:      <select name='answerSelect' required>";
                    echo "<option>Choose Answer</option>";
                            foreach ($db->query('SELECT * FROM answers') as $row)
                            {
                                echo "<option value=".$row['id'].">".$row['answer']."</option><br>";
                        }
                        echo "</select><br><br>";
                        echo "<input type='none' name='editId' value='$value'>";
                        echo "</div>";
                ?>
             -->
            <button class='button' onclick="submitResponse('edit')">Submit</button>
            <!-- </form>             -->
    </div>

    <div id="gamePage">
        <div id="gameQuestion" class="text"></div>
        <div id="gameAnswers" class="text"></div>
        <br>

        <span class='submit'><button class='button' onclick="result()" type='button'>Submit</button></span>
    </div>

    <div id="result">
        <!-- $selectedAns = $_POST['selected'];
        $correctAns = $_SESSION['Answer_id'];
        if($selectedAns == $correctAns)
        {
            $_SESSION['Score'] += 1;

            if($_SESSION['Score'] != 10) {
                <h1>Congrats.</h1><br> It was correct.<br><b> Your total score is Score;
                </b><br><button class='button'><a href = 'game.php'>Next Question</a></button>
            } else {
                Congrats you have completed the game.<br>
                <button class='button'><a href = 'millionaire.php'>Start Over</a></button>
                <button class='button'><a href = ''>Claim Reward</a></button>
            }
        } else {
            Boo.<br> It was incorrect.<br><b> Your final score is ". $_SESSION['Score']
            </b><br><button class='button'><a href = 'millionaire.php'>Start Over</a></button>
        } -->

        <span class='submit'><button class='button' onclick="startOver()" type='button'>Start Over</button></span>
        <span class='submit'><button class='button' onclick="startGame()" type='button'>Next Question</button></span>
    </div>

</body>

</html>